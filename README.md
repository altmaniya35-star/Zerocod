# Генератор PDF-счетов

Python-скрипт для генерации PDF-счетов из CSV и JSON файлов с использованием HTML-шаблонов.

## Описание

Скрипт позволяет:
- Читать данные из CSV и JSON файлов
- Использовать HTML-шаблоны для оформления счетов
- Генерировать PDF-документы с поддержкой кириллицы
- Автоматически разбивать длинные счета на страницы (10 строк на страницу)
- Автоматически открывать сгенерированные PDF-файлы

## Требования

- Python 3.7 или выше
- Windows или macOS

## Установка

1. Убедитесь, что у вас активировано виртуальное окружение:
```bash
# Windows
venv\Scripts\activate

# macOS/Linux
source venv/bin/activate
```

2. Установите зависимости:
```bash
pip install -r requirements.txt
```

## Структура проекта

```
.
├── data/                  # Директория с файлами данных (CSV, JSON)
│   ├── customer.csv       # Данные покупателей (CSV)
│   ├── customer.json      # Данные покупателей (JSON)
│   ├── product.csv        # Данные товаров (CSV)
│   ├── product.json       # Данные товаров (JSON)
│   ├── invoice.csv        # Данные счетов (CSV)
│   └── invoice.json       # Данные счетов (JSON)
├── templates/             # HTML-шаблоны
│   └── invoice.html       # Шаблон счёта
├── output/                # Директория для сгенерированных PDF
├── invoice_generator.py   # Основной скрипт
├── requirements.txt       # Зависимости проекта
└── README.md             # Документация
```

## Использование

1. Запустите скрипт:
```bash
python invoice_generator.py
```

2. Следуйте инструкциям в консоли:
   - Выберите файл данных (CSV или JSON)
   - Выберите HTML-шаблон
   - Выберите счёт по invoice_id
   - PDF будет автоматически сгенерирован и открыт

## Формат данных

### Customer (Покупатель)

**CSV формат:**
```csv
customer_id,name,email,phone,address
1,ООО "ТехноСервис",info@technoservice.ru,+7 (495) 123-45-67,"г. Москва, ул. Ленина, д. 10"
```

**JSON формат:**
```json
[
  {
    "customer_id": 1,
    "name": "ООО \"ТехноСервис\"",
    "email": "info@technoservice.ru",
    "phone": "+7 (495) 123-45-67",
    "address": "г. Москва, ул. Ленина, д. 10"
  }
]
```

### Product (Товар)

**CSV формат:**
```csv
product_id,name,price,description
1,Процессор Intel Core i5-12400F,12500.00,Процессор Intel Core i5-12400F
```

**JSON формат:**
```json
[
  {
    "product_id": 1,
    "name": "Процессор Intel Core i5-12400F",
    "price": 12500.00,
    "description": "Процессор Intel Core i5-12400F"
  }
]
```

### Invoice (Счёт)

**CSV формат:**
Каждая строка представляет один товар в счёте:
```csv
invoice_id,customer_id,date,product_id,quantity
1,1,2024-01-15,1,2
1,1,2024-01-15,2,1
```

**JSON формат:**
```json
[
  {
    "invoice_id": 1,
    "customer_id": 1,
    "date": "2024-01-15",
    "items": [
      {
        "product_id": 1,
        "quantity": 2
      },
      {
        "product_id": 2,
        "quantity": 1
      }
    ]
  }
]
```

## Особенности

### Поддержка кириллицы

Скрипт использует шрифт DejaVu Sans, который поддерживает кириллицу. Шрифт встроен в WeasyPrint.

### Пагинация

- Автоматическое разбиение на страницы при превышении 10 строк товаров
- Шапка таблицы (thead) повторяется на каждой странице
- Нумерация страниц внизу каждой страницы
- Итоговая сумма всегда на последней странице

### Кросс-платформенность

Скрипт работает на Windows и macOS:
- **Windows**: использует `os.startfile()` для открытия PDF
- **macOS**: использует команду `open` для открытия PDF

## Примеры использования

### Генерация счёта из CSV

1. Поместите файлы `customer.csv`, `product.csv`, `invoice.csv` в директорию `data/`
2. Запустите скрипт и выберите `invoice.csv`
3. Выберите шаблон `invoice.html`
4. Выберите нужный invoice_id

### Генерация счёта из JSON

1. Поместите файлы `customer.json`, `product.json`, `invoice.json` в директорию `data/`
2. Запустите скрипт и выберите `invoice.json`
3. Выберите шаблон `invoice.html`
4. Выберите нужный invoice_id

## Технические детали

### Библиотеки

- **WeasyPrint**: Генерация PDF из HTML/CSS
- **pandas**: Парсинг CSV файлов (опционально, можно использовать стандартную библиотеку csv)
- **json**: Стандартная библиотека Python для работы с JSON

### Обработка ошибок

Скрипт обрабатывает следующие ошибки:
- Отсутствие файлов данных или шаблонов
- Неверный формат данных
- Отсутствие связанных данных (customer, product)
- Ошибки генерации PDF

## Лицензия

Этот проект создан в учебных целях.

## Автор

Создано для курса Zerocoding Lesson 5.1
